CREATE DATABASE `DReBoot`;
CREATE TABLE `users` 
( 
	`id` int(10) auto_increment not null,
	`fio` varchar(150) not null,
	`login` varchar(50),
	`pswd` varchar(50),
	`bday` date,
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `achievements` 
( 
	`id` int(4) auto_increment not null,
	`name` varchar(150) not null,
	`image` varchar(300),
	`condition` varchar(300),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `GameResult` 
( 
	`user` int(4) not null,
	FOREIGN KEY (`user`)  REFERENCES `users`(`id`),
	`walkthrough` int(4)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `ReachedAch` 
( 
	`user` int(4) not null,
	`achievement` int(4) not null,
	FOREIGN KEY (`user`)  REFERENCES `users`(`id`),
	FOREIGN KEY (`achievement`)  REFERENCES `achievements`(`id`), 
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `tasktypes` 
( 
	`id` int(4) auto_increment not null,
	`name` varchar(100) not null,
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `tasks` 
( 
	`id` int(4) auto_increment not null,
	`type` int(4) not null,
	`name` varchar(100) not null,
	`descr` varchar(300),
	`question` boolean,
	FOREIGN KEY (`type`)  REFERENCES `tasktypes`(`id`),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;
CREATE TABLE `answers` 
( 
	`id` int(4) auto_increment not null,
	`task` int(4) not null,
	`descr` varchar(150),
	`value` int(4), 
	`action` boolean,
	FOREIGN KEY (`task`)  REFERENCES `tasks`(`id`),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `terms` 
( 
	`id` int(4) auto_increment not null,
	`name` varchar(100) not null,
	`descr` varchar(150),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `termUsage` 
( 
	`term` int(4) not null,
	`task` int(4) not null,
	FOREIGN KEY (`term`)  REFERENCES `terms`(`id`),
	FOREIGN KEY (`task`)  REFERENCES `tasks`(`id`)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `story` 
( 
	`id` int(4) auto_increment not null,
	`descr` varchar(300),
	`length` int(4),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;
CREATE TABLE `storytales` 
( 
	`id` int(4) auto_increment not null,
	`story` int(4) not null,
	`task` int(4) not null,
	`queue` int(4), 
	FOREIGN KEY (`story`)  REFERENCES `story`(`id`),
	FOREIGN KEY (`task`)  REFERENCES `tasks`(`id`),
	PRIMARY KEY(id)	
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;

CREATE TABLE `saves` 
( 
	`id` int(4) auto_increment not null,
	`user` int(4) not null,
	`storytales` int(4) not null,
	FOREIGN KEY (`user`)  REFERENCES `users`(`id`),
	FOREIGN KEY (`storytales`)  REFERENCES `storytales`(`id`),	
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;

CREATE TABLE `ILResult` 
( 
	`user` int(4) not null,
	`save` int(4) not null,
	`mark` int(4), 
	FOREIGN KEY (`user`)  REFERENCES `users`(`id`),
	FOREIGN KEY (`save`)  REFERENCES `saves`(`id`)	
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;
