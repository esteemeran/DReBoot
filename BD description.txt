CREATE DATABASE `DReBoot`;
CREATE TABLE `users` 
( 
	`id` int(10) auto_increment not null,
	`fio` varchar(150) not null,
	`login` varchar(50),
	`pswd` varchar(50),
	`bday` date,
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `achievements` 
( 
	`id` int(4) auto_increment not null,
	`name` varchar(150) not null,
	`image` varchar(300),
	`condition` varchar(300),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `GameResult` 
( 
	`userID` int(4) not null,
	FOREIGN KEY (`userID`)  REFERENCES `users`(`id`),
	`walkthrough` int(4)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `ReachedAch` 
( 
	`userID` int(4) not null,
	`achievementID` int(4) not null,
	FOREIGN KEY (`userID`)  REFERENCES `users`(`id`),
	FOREIGN KEY (`achievementID`)  REFERENCES `achievements`(`id`), 
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `tasktypes` 
( 
	`id` int(4) auto_increment not null,
	`name` varchar(100) not null,
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `tasks` 
( 
	`id` int(4) auto_increment not null,
	`typeID` int(4) not null,
	`name` varchar(100) not null,
	`descr` varchar(300),
	`question` boolean,
	FOREIGN KEY (`typeID`)  REFERENCES `tasktypes`(`id`),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;
CREATE TABLE `answers` 
( 
	`id` int(4) auto_increment not null,
	`taskID` int(4) not null,
	`descr` varchar(150),
	`value` int(4), 
	`action` boolean,
	FOREIGN KEY (`taskID`)  REFERENCES `tasks`(`id`),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `terms` 
( 
	`id` int(4) auto_increment not null,
	`name` varchar(100) not null,
	`descr` varchar(150),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 
CREATE TABLE `termUsage` 
( 
	`termID` int(4) not null,
	`taskID` int(4) not null,
	FOREIGN KEY (`termID`)  REFERENCES `terms`(`id`),
	FOREIGN KEY (`taskID`)  REFERENCES `tasks`(`id`)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8; 

CREATE TABLE `story` 
( 
	`id` int(4) auto_increment not null,
	`descr` varchar(300),
	`length` int(4),
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;
CREATE TABLE `storytales` 
( 
	`id` int(4) auto_increment not null,
	`storyID` int(4) not null,
	`taskID` int(4) not null,
	`queue` int(4), 
	FOREIGN KEY (`storyID`)  REFERENCES `story`(`id`),
	FOREIGN KEY (`taskID`)  REFERENCES `tasks`(`id`),
	PRIMARY KEY(id)	
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;

CREATE TABLE `saves` 
( 
	`id` int(4) auto_increment not null,
	`userID` int(4) not null,
	`storytalesID` int(4) not null,
	FOREIGN KEY (`userID`)  REFERENCES `users`(`id`),
	FOREIGN KEY (`storytalesID`)  REFERENCES `storytales`(`id`),	
	PRIMARY KEY(id)
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;

CREATE TABLE `ILResult` 
( 
	`userID` int(4) not null,
	`saveID` int(4) not null,
	`mark` int(4), 
	FOREIGN KEY (`userID`)  REFERENCES `users`(`id`),
	FOREIGN KEY (`saveID`)  REFERENCES `saves`(`id`)	
) ENGINE=InnoDB Auto_increment=1 default charset=utf8;